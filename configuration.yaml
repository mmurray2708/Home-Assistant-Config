homeassistant:
  # Name of the location where Home Assistant is running
  name: Home
  # Location required to calculate the time the sun rises and sets
  latitude: !secret lat
  longitude: !secret long
  # Impacts weather/sunrise data (altitude above sea level in meters)
  elevation: 0
  # metric for Metric, imperial for Imperial
  unit_system: imperial
  # Pick yours from here: http://en.wikipedia.org/wiki/List_of_tz_database_time_zones
  time_zone: America/Los_Angeles
  # Customization file
  customize: !include customize.yaml
  auth_mfa_modules:
    - type: notify
#  auth_providers:
#    - type: homeassistant  
# Configure a default setup of Home Assistant (frontend, api, etc)
default_config:

frontend:
  themes: !include_dir_merge_named themes/
  extra_html_url:
    - /local/custom_ui/state-card-floorplan.html

panel_custom:
  - name: Floorplan
    sidebar_title: Floorplan
    sidebar_icon: mdi:home
    url_path: floorplan
    config: !include floorplan.yaml

meross_cloud:
  username: !secret meross_username
  password: !secret meross_password

media_player:
  - platform: spotify
    client_id: !secret spotify_client_id
    client_secret: !secret spotify_client_secret

#image_processing:
#  - platform: tensorflow
#    source: 
#      - entity_id: camera.upstairs_outside
#      - entity_id: camera.driveway
#    file_out:
#      - "/config/www/{{ camera_entity.split('.')[1] }}_latest.jpg"
#    model:
#      graph: /config/tensorflow/frozen_inference_graph.pb
#      categories:
#        - category: person

hacs:
  token: !secret github_token

recorder:
  purge_keep_days: 30
  db_url: mysql://ha:Murray9825@10.200.200.122/ha?charset=utf8


# Show the introduction message on startup.
#introduction:


# Uncomment this if you are using SSL/TLS, running in Docker container, etc.
http:
  ssl_certificate: !secret ssl_certificate
  ssl_key: !secret ssl_key
  ip_ban_enabled: false
  login_attempts_threshold: 3
  base_url: https://murrayha.processtechag.com:8123
  cors_allowed_origins:
    - http://10.200.200.122:5050
# Discover some devices automatically


rachio:
  api_key: !secret rachio_api
  manual_run_mins: 60 

input_boolean:
  outside_motion_light_on:
    name: "Camera motion turned on light"
    initial: off
  garage_door_open:
    name: "Garage Door Open"
    initial: off
  house_fan_auto_turnoff:
    name: "House Fan Auto Turn-Off Enabled"
    initial: off
  vacation:
    name: "Vacation Mode"
    initial: off

discovery:

speedtestdotnet:
  server_id: 18531
  manual: true

homekit:
  filter:
    include_domains:
      - switch
      - cover
      - climate
      - group
    exclude_entities:
      - switch.driveway_motion_detection
      - switch.driveway_motion_recording
      - switch.garage_door
      - switch.upstairs_outside_motion_detection 
input_number:
  hf1:
    name: House Fan Timer
    initial: 90
    min: 15
    max: 360
    step: 15 
    mode: slider

google_assistant:
  project_id: home-assistant-223623
  api_key: !secret google_api_key
  exposed_domains:
    - switch
    - cover
    - group

  entity_config:
    switch.garage_door:
      name: "garage door"
      aliases:
        - Garage_door
      room: garage

juicenet:
  access_token: !secret juicenet_token

weather:
  - platform: darksky
    api_key: !secret darksky_api_key

ring:
  username: !secret ring_username
  password: !secret ring_password

binary_sensor:
  - platform: ring
  - platform: mqtt
    state_topic: dummy/floorplan/sensor
    name: Floorplan

tplink:
  discovery: false
  switch:
    - host: 10.200.230.34
    - host: 10.200.230.53
    - host: 10.200.230.55



amcrest:
  - host: 10.200.200.95
    username: !secret amcrest_username
    password: !secret amcrest_password_95
    name: "Driveway"
    sensors:
      - motion_detector
    scan_interval: 5
  - host: 10.200.200.166
    username: !secret amcrest_username
    password: !secret amcrest_password_166
    name: "Upstairs_Outside"
    sensors:
      - motion_detector
    scan_interval: 5

ios:

notify:
  - name: all
    platform: group
    services:
      - service: mobile_app_mmurrays_iphone
      - service: mobile_app_lindseys_iphone

mqtt:
  password: !secret mqtt_password

envisalink:
  host: 10.200.230.29
  panel_type: DSC
  user_name: !secret envisalink_user
  password: !secret envisalink_password
  port: 4025
  evl_version: 3
  keepalive_interval: 60
  zonedump_interval: 30
  timeout: 10
  panic_type: Police
  zones:
    1:
      name: 'Outside Doors'
      type: 'opening'
    2:
      name: 'Windows'
      type: 'opening'
    3:
      name: 'Back Slider'
      type: 'opening'
    6:
      name: 'Upstairs Bathroom'
      type: 'opening'
    7:
      name: 'Downstairs Motion'
      type: 'motion'
  partitions:
    1:
      name: 'Home Alarm'

# Sensors
sensor:
  # Weather prediction
  - platform: airvisual
    api_key: !secret airvisual_api_key
    monitored_conditions: 
      - us
  - platform: yr
  - platform: amcrest
  - platform: ring
  - platform: template
    sensors:
      solaredge_energy_today_kw:
        value_template: '{{(states.sensor.solaredge_energy_today.state | float / 1000) | round(2)}}'
      garage_door_status:
        value_template: >
          {{ 0.0 < states('sensor.garage_door_sensor') | float < 0.3 }} 
  - platform: darksky
    api_key: !secret darksky_api_key
    forecast:
      - 1
    hourly_forecast:
      - 0
      - 1
    monitored_conditions:
      - summary
      - icon
      - temperature
      - apparent_temperature
      - temperature_min
      - temperature_max 
      - humidity
      - precip_probability
      - precip_type
      - precip_intensity
      - wind_speed
      - wind_bearing
      - pressure
      - dew_point
      - precip_accumulation
      - wind_gust
      - nearest_storm_distance
      - nearest_storm_bearing
      - sunrise_time
      - sunset_time
      - moon_phase
      - alerts
  - platform: systemmonitor
    resources:
      - type: disk_use_percent
        arg: /home
      - type: memory_use
      - type: load_1m
      - type: load_5m
      - type: load_15m
      - type: processor_use
      - type: last_boot
  - platform: rest
    resource: !secret weatherlink_api_key
    scan_interval: 900
    name: weatherlink
    json_attributes:
    - temp_f
    - davis_current_observation
    value_template: '{{ value_json.weatherlink }}'
  - platform: template
    sensors:
      farm_temp:
        friendly_name: 'Farm Temp'
        unit_of_measurement: 'F'
        device_class: 'temperature'
        value_template: "{{ state_attr('sensor.weatherlink', 'temp_f') }}"
  - platform: template
    sensors:
      farm_storm_total:
        friendly_name: 'Farm Storm Total'
        unit_of_measurement: 'in'
        value_template: '{{ states.sensor.weatherlink.attributes["davis_current_observation"]["rain_storm_in"] }}'

cover:
  - platform: template
    covers:
      garage_door_cover:
        friendly_name: "Garage Door"
        value_template: "{{ states('sensor.garage_door_status') }}"
        open_cover: 
          service: switch.turn_on
          data:
            entity_id: switch.garage_door
        close_cover:
          service: switch.turn_on
          data:
            entity_id: switch.garage_door

camera:
  - platform: amcrest
  - platform: ring
#  - platform: local_file
#    file_path: /config/www/driveway_latest.jpg
#    name: Driveway_object_detect
#  - platform: local_file
#    file_path: /config/www/upstairs_outside_latest.jpg
#    name: Front_object_detect


# Text to speech
tts:
  - platform: google_translate
    service_name: google_say

zone:
  - name: Solid Networks
    latitude: 37.720768
    longitude: -121.096960
   
  - name: Big Valley
    latitude: 37.699684
    longitude: -121.006674
    radius: 300

logger:

group: !include groups.yaml
automation: !include automations.yaml
script: !include scripts.yaml
